# ğŸ¯ ì·¨ì•½ì  ìƒì„¸ ìŠ¤í™

## 1. Business Logic Vulnerability

### 1.1 ê°€ê²© ì¡°ì‘ ê³µê²© (Price Manipulation)
**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
- ìŒìˆ˜ ê°€ê²©ìœ¼ë¡œ í™˜ë¶ˆ ë°›ê¸°
- í• ì¸ìœ¨ 100% ì´ìƒ ì ìš©
- ì¿ í° ì¤‘ë³µ ì‚¬ìš©
- ìˆ˜ëŸ‰ê³¼ ê°€ê²© ë¶„ë¦¬ ì¡°ì‘

**êµ¬í˜„ ê³„íš:**
```php
// ì·¨ì•½í•œ êµ¬í˜„
$total = $_POST['quantity'] * $_POST['price'];

// ì•ˆì „í•œ êµ¬í˜„  
$total = validate_quantity($input) * get_product_price($product_id);
```

### 1.2 ê¶Œí•œ ìš°íšŒ ê³µê²© (Authorization Bypass)
**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
- ê´€ë¦¬ì í˜ì´ì§€ ì§ì ‘ ì ‘ê·¼
- ë‹¤ë¥¸ ì‚¬ìš©ì IDë¡œ ìš”ì²­ ì¡°ì‘
- ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ ìš°íšŒ

### 1.3 ì›Œí¬í”Œë¡œìš° ìš°íšŒ (Workflow Bypass)
**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
- ê²°ì œ ì—†ì´ ì£¼ë¬¸ ì™„ë£Œ
- ìŠ¹ì¸ ì ˆì°¨ ê±´ë„ˆë›°ê¸°
- ìˆœì„œ ë¬´ì‹œí•œ API í˜¸ì¶œ

## 2. Race Condition

### 2.1 TOCTOU (Time-of-Check-Time-of-Use)
**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
- ì”ì•¡ í™•ì¸ í›„ ì‚¬ìš© ì „ ì¡°ì‘
- íŒŒì¼ ê¶Œí•œ í™•ì¸ í›„ ë³€ê²½
- ì¤‘ë³µ ê²°ì œ ì²˜ë¦¬

**êµ¬í˜„ ê³„íš:**
```php
// ì·¨ì•½í•œ êµ¬í˜„
if (get_balance($user_id) >= $amount) {
    // ì—¬ê¸°ì„œ ë™ì‹œ ìš”ì²­ìœ¼ë¡œ ì”ì•¡ ë³€ê²½ ê°€ëŠ¥
    sleep(1); // ì‹œë®¬ë ˆì´ì…˜
    update_balance($user_id, -$amount);
}

// ì•ˆì „í•œ êµ¬í˜„ (ì›ìì  ì—°ì‚°)
$result = atomic_update_balance($user_id, -$amount);
```

### 2.2 ë™ì‹œì„± ê³µê²©
**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
- ë™ì‹œ ë¡œê·¸ì¸ìœ¼ë¡œ ì„¸ì…˜ ì¶©ëŒ
- íŒŒì¼ ì—…ë¡œë“œ ë ˆì´ìŠ¤ ì»¨ë””ì…˜
- ì¹´ìš´í„° ë™ì‹œ ì¦ê°€

## 3. Advanced Deserialization

### 3.1 Python Pickle ì·¨ì•½ì 
**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
```python
# ì•…ì˜ì ì¸ pickle ë°ì´í„°
import pickle
import os

class RCE:
    def __reduce__(self):
        return (os.system, ('rm -rf /',))

malicious = pickle.dumps(RCE())
```

### 3.2 .NET BinaryFormatter
**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
- ysoserial.net í™œìš©
- .NET ê°ì²´ ì¡°ì‘
- ì›ê²© ì½”ë“œ ì‹¤í–‰

### 3.3 PHP Object Injection
**ê³µê²© ì‹œë‚˜ë¦¬ì˜¤:**
```php
// ì·¨ì•½í•œ êµ¬í˜„
$user_data = unserialize($_COOKIE['user']);

// ì•…ì˜ì ì¸ ì¿ í‚¤
// O:4:"User":1:{s:4:"role";s:5:"admin";}
```

## 4. í…ŒìŠ¤íŠ¸ í™˜ê²½ ìš”êµ¬ì‚¬í•­

### Docker Services
```yaml
services:
  python_app:    # Python pickle í…ŒìŠ¤íŠ¸
  dotnet_app:    # .NET ì§ë ¬í™” í…ŒìŠ¤íŠ¸  
  race_test:     # ë™ì‹œì„± í…ŒìŠ¤íŠ¸ìš©
```

### í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **Python**: pickle, dill, cloudpickle
- **Node.js**: node-serialize, serialize-javascript
- **.NET**: BinaryFormatter, XmlSerializer
- **PHP**: serialize/unserialize

## 5. ì•ˆì „í•œ êµ¬í˜„ ê°€ì´ë“œ

### Business Logic ë³´ì•ˆ
```php
// 1. ì„œë²„ì‚¬ì´ë“œ ê²€ì¦
function validate_purchase($user_id, $product_id, $quantity, $price) {
    $actual_price = get_product_price($product_id);
    if ($price !== $actual_price) {
        throw new SecurityException("Price tampering detected");
    }
    
    if ($quantity <= 0 || $quantity > MAX_QUANTITY) {
        throw new ValidationException("Invalid quantity");
    }
    
    return calculate_total($actual_price, $quantity);
}

// 2. ê¶Œí•œ í™•ì¸
function check_authorization($user_id, $resource, $action) {
    $user_role = get_user_role($user_id);
    return has_permission($user_role, $resource, $action);
}
```

### Race Condition ë°©ì§€
```php
// 1. ì›ìì  ì—°ì‚° ì‚¬ìš©
$redis->multi()
      ->decrby("balance:$user_id", $amount)  
      ->incrby("balance:$target_id", $amount)
      ->exec();

// 2. ë½ ë©”ì»¤ë‹ˆì¦˜
$lock = acquire_lock("transfer:$user_id", 30);
try {
    perform_transfer($user_id, $target_id, $amount);
} finally {
    release_lock($lock);
}
```

### ì•ˆì „í•œ ì§ë ¬í™”
```php
// 1. JSON ì‚¬ìš© (íƒ€ì… ì•ˆì „)
$data = json_encode($object);
$object = json_decode($data, true);

// 2. í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ì§ë ¬í™”
$allowed_classes = ['User', 'Product', 'Order'];
$object = unserialize($data, ['allowed_classes' => $allowed_classes]);
```