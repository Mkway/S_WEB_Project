<?php
/**
 * Directory Traversal ÌÖåÏä§Ìä∏ ÌéòÏù¥ÏßÄ
 * PayloadsAllTheThingsÏùò Directory Traversal ÌéòÏù¥Î°úÎìúÎ•º Í∏∞Î∞òÏúºÎ°ú Íµ¨ÏÑ±
 */

session_start();
require_once '../db.php';
require_once '../utils.php';

// Î°úÍ∑∏Ïù∏ ÌôïÏù∏
if (!is_logged_in()) {
    header('Location: ../login.php');
    exit();
}

$result = '';
$error = '';
$path = $_POST['path'] ?? '';
$action = $_POST['action'] ?? 'read';

// Directory Traversal ÌéòÏù¥Î°úÎìú Î™®Ïùå (PayloadsAllTheThings Í∏∞Î∞ò)
$payloads = [
    'basic' => [
        '../',
        '../../',
        '../../../',
        '../../../../',
        '../../../../../',
        '../../../../../../',
        '../../../../../../../',
        '../../../../../../../../'
    ],
    'encoded' => [
        '%2e%2e/',
        '%2e%2e%2f',
        '..%2f',
        '..%252f',
        '..%c0%af',
        '..%ef%bc%8f',
        '..%c1%9c'
    ],
    'double_encoded' => [
        '%252e%252e%252f',
        '%252e%252e/',
        '..%255c',
        '..%255c%255c'
    ],
    'unicode' => [
        '..%u2215',
        '..%u2216',
        '..%uEFC8',
        '..%uF025'
    ],
    'bypass' => [
        '....///',
        '....\\\\\\',
        '....//',
        '....\\//',
        '..///',
        '..\\\\',
        '../\\',
        '..\\/'
    ],
    'common_files' => [
        '../etc/passwd',
        '../../etc/passwd',
        '../../../etc/passwd',
        '../../../../etc/passwd',
        '../etc/shadow',
        '../etc/hosts',
        '../proc/version',
        '../proc/self/environ',
        '../var/log/apache2/access.log',
        '../var/log/nginx/access.log'
    ],
    'windows' => [
        '..\\windows\\system32\\config\\sam',
        '..\\..\\windows\\system32\\config\\sam',
        '..\\windows\\system32\\drivers\\etc\\hosts',
        '..\\boot.ini',
        '..\\windows\\win.ini',
        '..\\windows\\system.ini',
        '..\\inetpub\\logs\\logfiles\\w3svc1\\',
        'C:\\windows\\system32\\config\\sam',
        'C:\\boot.ini'
    ]
];

// ÏïàÏ†ÑÌïú ÎîîÎ†âÌÜ†Î¶¨ Íµ¨Ï°∞ (ÏãúÎÆ¨Î†àÏù¥ÏÖòÏö©)
$safe_structure = [
    'public' => [
        'index.html' => 'Welcome to our website!',
        'about.html' => 'About us page content',
        'contact.html' => 'Contact information'
    ],
    'uploads' => [
        'image1.jpg' => '[JPEG Image Data]',
        'document.pdf' => '[PDF Document Data]'
    ],
    'logs' => [
        'access.log' => '127.0.0.1 - - [01/Jan/2024:00:00:01] "GET / HTTP/1.1" 200',
        'error.log' => '[error] [client 127.0.0.1] File does not exist'
    ]
];

// ÌÖåÏä§Ìä∏ Ïã§Ìñâ
if ($_POST && isset($_POST['path'])) {
    // ÏúÑÌóòÌïú Ìå®ÌÑ¥ Í∞êÏßÄ
    $dangerous_patterns = [
        '/\.\.\//',           // Basic traversal
        '/\.\.\\\\/',         // Windows traversal
        '/%2e%2e/',           // URL encoded
        '/%252e/',            // Double encoded
        '/etc\/passwd/',      // System files
        '/etc\/shadow/',      // Shadow file
        '/proc\//',           // Process files
        '/var\/log/',         // Log files
        '/windows\//',        // Windows system
        '/boot\.ini/',        // Windows boot
        '/system32\//',       // Windows system32
    ];
    
    $is_dangerous = false;
    $detected_patterns = [];
    
    foreach ($dangerous_patterns as $pattern) {
        if (preg_match($pattern, strtolower($path))) {
            $is_dangerous = true;
            $detected_patterns[] = str_replace('/', '', $pattern);
        }
    }
    
    if ($is_dangerous) {
        $result = "‚ö†Ô∏è ÏúÑÌóòÌïú Directory Traversal Í≥µÍ≤©Ïù¥ Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§!\n\n";
        $result .= "ÏûÖÎ†•Îêú Í≤ΩÎ°ú: " . htmlspecialchars($path) . "\n";
        $result .= "Í∞êÏßÄÎêú Ìå®ÌÑ¥: " . implode(', ', $detected_patterns) . "\n\n";
        
        // Ïã§Ï†ú Í≥µÍ≤©Ïù¥ÏóàÎã§Î©¥ Ïñ¥Îñ§ ÏùºÏù¥ ÏùºÏñ¥ÎÇ¨ÏùÑÏßÄ ÏãúÎÆ¨Î†àÏù¥ÏÖò
        $result .= "üéØ Í≥µÍ≤© ÏãúÎÆ¨Î†àÏù¥ÏÖò:\n";
        
        if (preg_match('/etc\/passwd/', strtolower($path))) {
            $result .= "ÎßåÏïΩ Ï∑®ÏïΩÌñàÎã§Î©¥ ÏãúÏä§ÌÖú ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥Í∞Ä ÎÖ∏Ï∂úÎêòÏóàÏùÑ Í≤ÉÏûÖÎãàÎã§:\n";
            $result .= "root:x:0:0:root:/root:/bin/bash\n";
            $result .= "daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n";
            $result .= "www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n";
        } elseif (preg_match('/etc\/shadow/', strtolower($path))) {
            $result .= "ÎßåÏïΩ Ï∑®ÏïΩÌñàÎã§Î©¥ ÏïîÌò∏ Ìï¥ÏãúÍ∞Ä ÎÖ∏Ï∂úÎêòÏóàÏùÑ Í≤ÉÏûÖÎãàÎã§:\n";
            $result .= "root:$6$randomsalt$hashedpassword::0:99999:7:::\n";
            $result .= "daemon:*:18474:0:99999:7:::\n";
        } elseif (preg_match('/boot\.ini/', strtolower($path))) {
            $result .= "ÎßåÏïΩ Ï∑®ÏïΩÌñàÎã§Î©¥ Windows Î∂ÄÌåÖ Ï†ïÎ≥¥Í∞Ä ÎÖ∏Ï∂úÎêòÏóàÏùÑ Í≤ÉÏûÖÎãàÎã§:\n";
            $result .= "[boot loader]\ntimeout=30\ndefault=multi(0)disk(0)rdisk(0)partition(1)\\WINDOWS\n";
        } else {
            $result .= "ÏãúÏä§ÌÖúÏùò Ï§ëÏöîÌïú ÌååÏùºÏóê Î¨¥Îã® Ï†ëÍ∑ºÏùÑ ÏãúÎèÑÌñàÏäµÎãàÎã§.\n";
            $result .= "Ïù¥Îäî Ïã¨Í∞ÅÌïú Î≥¥Ïïà ÏúÑÌóòÏùÑ Ï¥àÎûòÌï† Ïàò ÏûàÏäµÎãàÎã§.";
        }
        
        $result .= "\n\nüõ°Ô∏è Îã§ÌñâÌûà Ïù¥ ÏãúÏä§ÌÖúÏùÄ Ï†ÅÏ†àÌïú Î≥¥Ïïà Ï°∞ÏπòÎ°ú Î≥¥Ìò∏ÎêòÍ≥† ÏûàÏäµÎãàÎã§.";
        
    } else {
        // ÏïàÏ†ÑÌïú Í≤ΩÎ°ú Ï≤òÎ¶¨
        $clean_path = trim($path, '/\\');
        $path_parts = explode('/', $clean_path);
        
        if (count($path_parts) == 1 && isset($safe_structure[$path_parts[0]])) {
            // ÎîîÎ†âÌÜ†Î¶¨ Î™©Î°ù ÌëúÏãú
            $result = "‚úÖ ÎîîÎ†âÌÜ†Î¶¨ ÎÇ¥Ïö©:\n\n";
            $result .= "ÎîîÎ†âÌÜ†Î¶¨: /" . htmlspecialchars($path_parts[0]) . "/\n\n";
            foreach ($safe_structure[$path_parts[0]] as $file => $content) {
                $result .= "üìÑ " . htmlspecialchars($file) . "\n";
            }
        } elseif (count($path_parts) == 2 && isset($safe_structure[$path_parts[0]][$path_parts[1]])) {
            // ÌååÏùº ÎÇ¥Ïö© ÌëúÏãú
            $result = "‚úÖ ÌååÏùº ÎÇ¥Ïö©:\n\n";
            $result .= "ÌååÏùº: /" . htmlspecialchars(implode('/', $path_parts)) . "\n\n";
            $result .= htmlspecialchars($safe_structure[$path_parts[0]][$path_parts[1]]);
        } else {
            $result = "‚ùå ÏöîÏ≤≠Ìïú Í≤ΩÎ°úÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.\n\n";
            $result .= "ÏÇ¨Ïö© Í∞ÄÎä•Ìïú ÎîîÎ†âÌÜ†Î¶¨:\n" . implode(', ', array_keys($safe_structure));
        }
    }
}
?>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Directory Traversal ÌÖåÏä§Ìä∏ - Î≥¥Ïïà ÌÖåÏä§Ìä∏</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        .payload-section {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .payload-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 10px 0;
        }
        
        .payload-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-family: monospace;
        }
        
        .payload-btn:hover {
            background: #5a6268;
        }
        
        .payload-btn.dangerous {
            background: #dc3545;
        }
        
        .payload-btn.dangerous:hover {
            background: #c82333;
        }
        
        .test-form {
            background: white;
            border: 2px solid #dc3545;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .result-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            color: #155724;
            font-family: monospace;
            white-space: pre-wrap;
        }
        
        .danger-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            color: #721c24;
        }
        
        .info-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            color: #0c5460;
        }
        
        .safe-structure {
            background: #d4edda;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        input[type="text"] {
            width: 100%;
            font-family: monospace;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 10px;
        }
        
        .examples {
            background: #fff3cd;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        code {
            background: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: monospace;
        }
        
        .severity-high {
            color: #dc3545;
            font-weight: bold;
        }
        
        .severity-critical {
            color: #721c24;
            font-weight: bold;
            background: #f8d7da;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
        <nav class="nav">
            <h1>Directory Traversal ÌÖåÏä§Ìä∏</h1>
            <div class="nav-links">
                <a href="index.php" class="btn">Î≥¥Ïïà ÌÖåÏä§Ìä∏ Î©îÏù∏</a>
                <a href="../index.php" class="btn">Ìôà</a>
            </div>
        </nav>

        <!-- Î∏åÎ†àÎìúÌÅ¨Îüº -->
        <nav class="breadcrumb">
            <a href="../index.php">Ìôà</a> &gt; 
            <a href="index.php">Î≥¥Ïïà ÌÖåÏä§Ìä∏</a> &gt; 
            <span>Directory Traversal</span>
        </nav>

        <!-- ÏÑ§Î™Ö -->
        <div class="info-box">
            <h3>üìÇ Directory Traversal ÌÖåÏä§Ìä∏</h3>
            <p><strong>Directory Traversal</strong> (Path Traversal)ÏùÄ Ïõπ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏù¥ ÌååÏùº Í≤ΩÎ°úÎ•º Î∂ÄÏ†ÅÏ†àÌïòÍ≤å Ï≤òÎ¶¨Ìï† Îïå Î∞úÏÉùÌïòÎäî Ï∑®ÏïΩÏ†êÏûÖÎãàÎã§.</p>
            <p>Í≥µÍ≤©ÏûêÍ∞Ä <code>../</code> Í∞ôÏùÄ ÏãúÌÄÄÏä§Î•º ÏÇ¨Ïö©ÌïòÏó¨ Ïõπ Î£®Ìä∏ ÎîîÎ†âÌÜ†Î¶¨ Î∞ñÏùò ÌååÏùºÏóê Ï†ëÍ∑ºÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
            <p><strong>Ï∞∏Í≥†:</strong> Ïù¥ ÌéòÏù¥ÏßÄÏóêÏÑúÎäî Ïã§Ï†ú ÏãúÏä§ÌÖú ÌååÏùºÏóê Ï†ëÍ∑ºÌïòÏßÄ ÏïäÍ≥† ÏïàÏ†ÑÌïòÍ≤å ÏãúÎÆ¨Î†àÏù¥ÏÖòÌï©ÎãàÎã§.</p>
        </div>

        <!-- Í≤ΩÍ≥† -->
        <div class="danger-box">
            <h3>‚ö†Ô∏è <span class="severity-critical">CRITICAL</span> Î≥¥Ïïà ÏúÑÌóò</h3>
            <p>Directory Traversal Ï∑®ÏïΩÏ†êÏùÄ Îã§ÏùåÍ≥º Í∞ôÏùÄ Ïã¨Í∞ÅÌïú Í≤∞Í≥ºÎ•º Ï¥àÎûòÌï† Ïàò ÏûàÏäµÎãàÎã§:</p>
            <ul>
                <li><span class="severity-high">ÎØºÍ∞êÌïú ÏãúÏä§ÌÖú ÌååÏùº ÎÖ∏Ï∂ú</span> (/etc/passwd, /etc/shadow, boot.ini Îì±)</li>
                <li><span class="severity-high">Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò ÏÜåÏä§ ÏΩîÎìú ÎÖ∏Ï∂ú</span></li>
                <li><span class="severity-high">Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÑ§Ï†ï ÌååÏùº ÎÖ∏Ï∂ú</span></li>
                <li><span class="severity-high">Î°úÍ∑∏ ÌååÏùºÏùÑ ÌÜµÌïú Ï†ïÎ≥¥ ÏàòÏßë</span></li>
                <li><span class="severity-critical">Ï†ÑÏ≤¥ ÏãúÏä§ÌÖú Í∂åÌïú ÌÉàÏ∑® Í∞ÄÎä•</span></li>
            </ul>
        </div>

        <!-- Basic Traversal -->
        <div class="payload-section">
            <h3>üîß Basic Directory Traversal</h3>
            <p>Í∏∞Î≥∏Ï†ÅÏù∏ <code>../</code> ÏãúÌÄÄÏä§Î•º ÏÇ¨Ïö©Ìïú ÎîîÎ†âÌÜ†Î¶¨ ÏàúÌöåÏûÖÎãàÎã§.</p>
            <div class="payload-buttons">
                <?php foreach ($payloads['basic'] as $p): ?>
                    <button class="payload-btn dangerous" onclick="setPayload('<?php echo addslashes($p); ?>etc/passwd')">
                        <?php echo htmlspecialchars($p); ?>
                    </button>
                <?php endforeach; ?>
            </div>
        </div>

        <!-- URL Encoded -->
        <div class="payload-section">
            <h3>üî§ URL Encoded Traversal</h3>
            <p>URL Ïù∏ÏΩîÎî©ÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ ÌïÑÌÑ∞Î•º Ïö∞ÌöåÌïòÎäî Í∏∞Î≤ïÏûÖÎãàÎã§.</p>
            <div class="payload-buttons">
                <?php foreach ($payloads['encoded'] as $p): ?>
                    <button class="payload-btn dangerous" onclick="setPayload('<?php echo addslashes($p); ?>etc/passwd')">
                        <?php echo htmlspecialchars($p); ?>
                    </button>
                <?php endforeach; ?>
            </div>
        </div>

        <!-- Double Encoded -->
        <div class="payload-section">
            <h3>üîÑ Double URL Encoded</h3>
            <p>Ïù¥Ï§ë URL Ïù∏ÏΩîÎî©ÏùÑ ÌÜµÌïú Í≥†Í∏â Ïö∞Ìöå Í∏∞Î≤ïÏûÖÎãàÎã§.</p>
            <div class="payload-buttons">
                <?php foreach ($payloads['double_encoded'] as $p): ?>
                    <button class="payload-btn dangerous" onclick="setPayload('<?php echo addslashes($p); ?>etc/passwd')">
                        <?php echo htmlspecialchars($p); ?>
                    </button>
                <?php endforeach; ?>
            </div>
        </div>

        <!-- Unicode -->
        <div class="payload-section">
            <h3>üåê Unicode Encoding</h3>
            <p>Ïú†ÎãàÏΩîÎìú Ïù∏ÏΩîÎî©ÏùÑ ÏÇ¨Ïö©Ìïú ÌïÑÌÑ∞ Ïö∞Ìöå Í∏∞Î≤ïÏûÖÎãàÎã§.</p>
            <div class="payload-buttons">
                <?php foreach ($payloads['unicode'] as $p): ?>
                    <button class="payload-btn dangerous" onclick="setPayload('<?php echo addslashes($p); ?>etc/passwd')">
                        <?php echo htmlspecialchars($p); ?>
                    </button>
                <?php endforeach; ?>
            </div>
        </div>

        <!-- Filter Bypass -->
        <div class="payload-section">
            <h3>üö´ Filter Bypass Techniques</h3>
            <p>Îã§ÏñëÌïú ÌïÑÌÑ∞ÎßÅ Î©îÏª§ÎãàÏ¶òÏùÑ Ïö∞ÌöåÌïòÎäî Í∏∞Î≤ïÎì§ÏûÖÎãàÎã§.</p>
            <div class="payload-buttons">
                <?php foreach ($payloads['bypass'] as $p): ?>
                    <button class="payload-btn dangerous" onclick="setPayload('<?php echo addslashes($p); ?>etc/passwd')">
                        <?php echo htmlspecialchars($p); ?>
                    </button>
                <?php endforeach; ?>
            </div>
        </div>

        <!-- Common Target Files -->
        <div class="payload-section">
            <h3>üéØ Common Target Files</h3>
            <p>Í≥µÍ≤©ÏûêÎì§Ïù¥ Ï£ºÎ°ú ÎÖ∏Î¶¨Îäî ÏãúÏä§ÌÖú ÌååÏùºÎì§ÏûÖÎãàÎã§.</p>
            <div class="payload-buttons">
                <?php foreach ($payloads['common_files'] as $p): ?>
                    <button class="payload-btn dangerous" onclick="setPayload('<?php echo addslashes($p); ?>')" title="<?php echo htmlspecialchars($p); ?>">
                        <?php echo htmlspecialchars(basename($p)); ?>
                    </button>
                <?php endforeach; ?>
            </div>
        </div>

        <!-- Windows Targets -->
        <div class="payload-section">
            <h3>ü™ü Windows System Files</h3>
            <p>Windows ÌôòÍ≤ΩÏóêÏÑú ÎÖ∏Î¶¨Îäî Ï§ëÏöîÌïú ÏãúÏä§ÌÖú ÌååÏùºÎì§ÏûÖÎãàÎã§.</p>
            <div class="payload-buttons">
                <?php foreach ($payloads['windows'] as $p): ?>
                    <button class="payload-btn dangerous" onclick="setPayload('<?php echo addslashes($p); ?>')" title="<?php echo htmlspecialchars($p); ?>">
                        <?php echo htmlspecialchars(substr($p, -20)); ?>
                    </button>
                <?php endforeach; ?>
            </div>
        </div>

        <!-- ÏïàÏ†ÑÌïú ÎîîÎ†âÌÜ†Î¶¨ Íµ¨Ï°∞ -->
        <div class="safe-structure">
            <h3>‚úÖ ÌÖåÏä§Ìä∏ Í∞ÄÎä•Ìïú ÏïàÏ†ÑÌïú Íµ¨Ï°∞</h3>
            <p>Ïù¥ ÌéòÏù¥ÏßÄÏóêÏÑúÎäî Ïã§Ï†ú ÏãúÏä§ÌÖú ÌååÏùº ÎåÄÏã† Îã§Ïùå Íµ¨Ï°∞Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§:</p>
            <div class="payload-buttons">
                <button class="payload-btn" onclick="setPayload('public')" style="background: #28a745;">public/</button>
                <button class="payload-btn" onclick="setPayload('uploads')" style="background: #28a745;">uploads/</button>
                <button class="payload-btn" onclick="setPayload('logs')" style="background: #28a745;">logs/</button>
                <button class="payload-btn" onclick="setPayload('public/index.html')" style="background: #17a2b8;">public/index.html</button>
                <button class="payload-btn" onclick="setPayload('uploads/image1.jpg')" style="background: #17a2b8;">uploads/image1.jpg</button>
            </div>
        </div>

        <!-- ÌÖåÏä§Ìä∏ Ìèº -->
        <form method="post" class="test-form">
            <h3>üß™ Directory Traversal ÌÖåÏä§Ìä∏</h3>
            <label for="path">ÌååÏùº/ÎîîÎ†âÌÜ†Î¶¨ Í≤ΩÎ°ú:</label>
            <input type="text" name="path" id="path" placeholder="Ïòà: ../../../etc/passwd ÎòêÎäî public/" value="<?php echo htmlspecialchars($path); ?>">
            <br><br>
            <button type="submit" class="btn" style="background: #dc3545;">Í≤ΩÎ°ú Ï†ëÍ∑º ÌÖåÏä§Ìä∏</button>
        </form>

        <!-- Í≤∞Í≥º ÌëúÏãú -->
        <?php if ($result): ?>
            <div class="result-box">
                <h3>üìä ÌÖåÏä§Ìä∏ Í≤∞Í≥º</h3>
                <?php echo $result; ?>
            </div>
        <?php endif; ?>

        <!-- ÏòàÏ†ú Í≥µÍ≤© ÏãúÎÇòÎ¶¨Ïò§ -->
        <div class="examples">
            <h3>üí° Í≥µÍ≤© ÏãúÎÇòÎ¶¨Ïò§ ÏòàÏ†ú</h3>
            <p><strong>ÏãúÎÇòÎ¶¨Ïò§ 1:</strong> Ïõπ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏù¥ <code>?file=page.html</code> ÌòïÌÉúÎ°ú ÌååÏùºÏùÑ ÏùΩÏñ¥Ïò¨ Îïå</p>
            <code>?file=../../../etc/passwd</code> ‚Üí ÏãúÏä§ÌÖú ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ ÎÖ∏Ï∂ú
            <br><br>
            <p><strong>ÏãúÎÇòÎ¶¨Ïò§ 2:</strong> ÌååÏùº Îã§Ïö¥Î°úÎìú Í∏∞Îä•ÏóêÏÑú</p>
            <code>download.php?filename=../../../etc/shadow</code> ‚Üí ÏïîÌò∏ Ìï¥Ïãú ÎÖ∏Ï∂ú
            <br><br>
            <p><strong>ÏãúÎÇòÎ¶¨Ïò§ 3:</strong> Ïù¥ÎØ∏ÏßÄ ÌëúÏãú Í∏∞Îä•ÏóêÏÑú</p>
            <code>image.php?img=../../../../var/log/apache2/access.log</code> ‚Üí Î°úÍ∑∏ ÌååÏùº ÎÖ∏Ï∂ú
        </div>

        <!-- Î∞©Ïñ¥ Î∞©Î≤ï -->
        <div class="info-box">
            <h3>üõ°Ô∏è Directory Traversal Î∞©Ïñ¥ Î∞©Î≤ï</h3>
            <ul>
                <li><strong>ÏûÖÎ†• Í≤ÄÏ¶ù:</strong> ÏÇ¨Ïö©Ïûê ÏûÖÎ†•ÏóêÏÑú <code>../</code>, <code>..\</code> Îì± ÏúÑÌóòÌïú Ìå®ÌÑ¥ ÌïÑÌÑ∞ÎßÅ</li>
                <li><strong>ÌôîÏù¥Ìä∏Î¶¨Ïä§Ìä∏ Î∞©Ïãù:</strong> ÌóàÏö©Îêú ÌååÏùº/ÎîîÎ†âÌÜ†Î¶¨ Î™©Î°ùÎßå ÏÇ¨Ïö©</li>
                <li><strong>Í≤ΩÎ°ú Ï†ïÍ∑úÌôî:</strong> <code>realpath()</code>, <code>Path.GetFullPath()</code> Îì±ÏúºÎ°ú Í≤ΩÎ°ú Ï†ïÍ∑úÌôî</li>
                <li><strong>Chroot Jail:</strong> ÌîÑÎ°úÏÑ∏Ïä§Î•º ÌäπÏ†ï ÎîîÎ†âÌÜ†Î¶¨Î°ú Ï†úÌïú</li>
                <li><strong>ÌååÏùºÎ™ÖÎßå ÏÇ¨Ïö©:</strong> <code>basename()</code>ÏúºÎ°ú ÎîîÎ†âÌÜ†Î¶¨ Í≤ΩÎ°ú Ï†úÍ±∞</li>
                <li><strong>Ï†ëÍ∑º Í∂åÌïú Ï†úÌïú:</strong> Ïõπ ÏÑúÎ≤Ñ ÌîÑÎ°úÏÑ∏Ïä§ Í∂åÌïú ÏµúÏÜåÌôî</li>
                <li><strong>WAF ÏÇ¨Ïö©:</strong> Ïõπ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Î∞©ÌôîÎ≤ΩÏúºÎ°ú Ìå®ÌÑ¥ Ï∞®Îã®</li>
            </ul>
        </div>

        <!-- ÏúÑÌóòÌïú Ìå®ÌÑ¥Îì§ -->
        <div style="background: #f8d7da; padding: 20px; border-radius: 8px; margin-top: 20px;">
            <h3>‚ö†Ô∏è ÏúÑÌóòÌïú Ìå®ÌÑ¥ Î∞è Î¨∏ÏûêÎì§</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h4>Í∏∞Î≥∏ Ìå®ÌÑ¥:</h4>
                    <code>../</code>, <code>..\</code>, <code>./</code>, <code>.\</code>
                    <h4>Ïù∏ÏΩîÎî©Îêú Ìå®ÌÑ¥:</h4>
                    <code>%2e%2e%2f</code>, <code>%2e%2e%5c</code>, <code>%252e</code>
                </div>
                <div>
                    <h4>Ïö∞Ìöå Í∏∞Î≤ï:</h4>
                    <code>....//</code>, <code>..../</code>, <code>..\\</code>
                    <h4>Ï†àÎåÄ Í≤ΩÎ°ú:</h4>
                    <code>/etc/</code>, <code>C:\</code>, <code>/proc/</code>
                </div>
            </div>
        </div>

        <!-- Ï∞∏Í≥† ÏûêÎ£å -->
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 20px;">
            <h3>üìö Ï∞∏Í≥† ÏûêÎ£å</h3>
            <ul>
                <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Directory%20Traversal" target="_blank">PayloadsAllTheThings - Directory Traversal</a></li>
                <li><a href="https://owasp.org/www-community/attacks/Path_Traversal" target="_blank">OWASP - Path Traversal</a></li>
                <li><a href="https://portswigger.net/web-security/file-path-traversal" target="_blank">PortSwigger - Directory Traversal</a></li>
                <li><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22: Path Traversal</a></li>
            </ul>
        </div>
    </div>

    <script>
        function setPayload(payload) {
            document.getElementById('path').value = payload;
        }

        // Ïã§ÏãúÍ∞Ñ ÏúÑÌóò Ìå®ÌÑ¥ Í∞êÏßÄ
        document.getElementById('path').addEventListener('input', function() {
            const value = this.value.toLowerCase();
            const dangerousPatterns = [
                /\.\.\//,          // Basic traversal
                /\.\.%2f/,         // URL encoded
                /\.\.%5c/,         // Backslash encoded
                /%2e%2e/,          // Dot encoded
                /%252e/,           // Double encoded
                /etc\/passwd/,     // System files
                /etc\/shadow/,     // Shadow file
                /boot\.ini/,       // Windows boot
                /system32/,        // Windows system
                /proc\//,          // Process files
                /var\/log/         // Log files
            ];
            
            let isDangerous = false;
            for (let pattern of dangerousPatterns) {
                if (pattern.test(value)) {
                    isDangerous = true;
                    break;
                }
            }
            
            if (isDangerous) {
                this.style.borderColor = '#dc3545';
                this.style.backgroundColor = '#fff5f5';
            } else {
                this.style.borderColor = '#28a745';
                this.style.backgroundColor = '#f8fff8';
            }
        });

        // Ìèº Ï†úÏ∂ú Ïãú ÌôïÏù∏
        document.querySelector('form').addEventListener('submit', function(e) {
            const path = document.getElementById('path').value.toLowerCase();
            const dangerousPatterns = [
                /\.\.\//,
                /\.\.%2f/,
                /%2e%2e/,
                /%252e/,
                /etc\/passwd/,
                /etc\/shadow/,
                /boot\.ini/,
                /system32/,
                /proc\//,
                /var\/log/
            ];
            
            let isDangerous = false;
            for (let pattern of dangerousPatterns) {
                if (pattern.test(path)) {
                    isDangerous = true;
                    break;
                }
            }
            
            if (isDangerous) {
                const confirmed = confirm(
                    'ÏûÖÎ†•Îêú Í≤ΩÎ°úÏóê ÏúÑÌóòÌïú Directory Traversal Ìå®ÌÑ¥Ïù¥ Ìè¨Ìï®ÎêòÏñ¥ ÏûàÏäµÎãàÎã§.\n' +
                    'Ïù¥Îäî ÏãúÏä§ÌÖú ÌååÏùºÏóê Î¨¥Îã® Ï†ëÍ∑ºÏùÑ ÏãúÎèÑÌïòÎäî Í≥µÍ≤©Ïùº Ïàò ÏûàÏäµÎãàÎã§.\n\n' +
                    'ÍµêÏú° Î™©Ï†ÅÏúºÎ°ú Í≥ÑÏÜç ÏßÑÌñâÌïòÏãúÍ≤†ÏäµÎãàÍπå?'
                );
                
                if (!confirmed) {
                    e.preventDefault();
                }
            } else {
                const confirmed = confirm(
                    'Directory Traversal ÌÖåÏä§Ìä∏Î•º Ïã§ÌñâÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n' +
                    'Ïù¥ ÌÖåÏä§Ìä∏Îäî ÍµêÏú° Î™©Ï†ÅÏúºÎ°úÎßå ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî.'
                );
                
                if (!confirmed) {
                    e.preventDefault();
                }
            }
        });
    </script>
</body>
</html>